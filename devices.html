<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>فرم ثبت اطلاعات دیوایس‌</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/rastikerdar/vazir-font@v30.1.0/dist/font-face.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- تقویم شمسی دقیق و سبک -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/datepicker-fa/dist/datepicker.min.css">
</head>
<body>
<div class="container" style="max-width:650px;margin:auto;background:#fff;padding:1.8rem;border-radius:10px;box-shadow:0 0 0.5rem rgba(0,0,0,0.1);margin-top:2rem;">
  <h2 style="text-align:center;margin-bottom:1.35rem;font-size:1.2rem;">فرم ثبت اطلاعات دیوایس‌های معیوب</h2>
  <form id="deviceForm">
    <div style="padding:0.45rem 0;text-align:right;margin-bottom:0.9rem;font-size:0.9rem;color:#2c3e50;font-weight:bold;">
      بارکد فعلی: <span id="barcodeDisplay" style="font-family:'Courier New',Courier,monospace;background-color:#eee;padding:0.09rem 0.36rem;border-radius:4px;">---</span>
    </div>
    <input type="hidden" id="barcodeId" name="barcodeId">
    <!-- کارت ۱: نام و کد دیوایس -->
    <div style="background:#fff;border-radius:10px;padding:1rem;margin-bottom:1rem;box-shadow:0 2px 6px rgba(0,0,0,0.07);border:1px solid #e0e0e0;">
      <div style="display:flex;flex-direction:column;align-items:center;gap:0.85rem;">
        <label style="width:80%;text-align:right;font-weight:bold;">نام دیوایس</label>
        <select name="deviceName" id="deviceName" required style="width:80%;padding:0.54rem;border-radius:6px;">
          <option value="">-- انتخاب کنید --</option>
          <option value="Multi Media">Multi Media</option>
          <option value="Multi Media Metal">Multi Media Metal</option>
          <option value="Soul">Soul</option>
          <option value="Smart Player">Smart Player</option>
          <option value="TDA">TDA</option>
          <option value="RFID">RFID</option>
          <option value="Serial GSM">Serial GSM</option>
          <option value="Smart GSM">Smart GSM</option>
          <option value="MP3">MP3</option>
          <option value="IR">IR</option>
          <option value="B1">B1</option>
          <option value="Smart Plug">Smart Plug</option>
        </select>
        <label style="width:80%;text-align:right;font-weight:bold;">کد دیوایس</label>
        <input type="text" name="deviceCode" required style="width:80%;padding:0.54rem;border-radius:6px;">
      </div>
    </div>
    <!-- کارت ۲: ایراد -->
    <div style="background:#fff;border-radius:10px;padding:1rem;margin-bottom:1rem;box-shadow:0 2px 6px rgba(0,0,0,0.07);border:1px solid #e0e0e0;">
      <div style="display:flex;flex-direction:column;align-items:center;gap:0.85rem;">
        <label style="width:80%;text-align:right;font-weight:bold;">ایراد</label>
        <input type="text" name="issue" required style="width:80%;padding:0.54rem;border-radius:6px;">
        <label style="width:80%;text-align:right;font-weight:bold;">تاریخ گزارش ایراد</label>
        <input type="text" name="issueDate" id="issueDate" placeholder="تاریخ گزارش ایراد" autocomplete="off" style="width:80%;padding:0.54rem;border-radius:6px;">
        <label style="width:80%;text-align:right;font-weight:bold;">شرح ایراد</label>
        <textarea name="issueDescription" rows="2" style="width:80%;padding:0.54rem;border-radius:6px;"></textarea>
      </div>
    </div>
    <!-- کارت ۳: اقدامات و توضیحات -->
    <div style="background:#fff;border-radius:10px;padding:1rem;margin-bottom:1rem;box-shadow:0 2px 6px rgba(0,0,0,0.07);border:1px solid #e0e0e0;">
      <div style="display:flex;flex-direction:column;align-items:center;gap:0.85rem;">
        <label style="width:80%;text-align:right;font-weight:bold;">اقدامات انجام شده</label>
        <textarea name="actionsTaken" rows="2" style="width:80%;padding:0.54rem;border-radius:6px;"></textarea>
        <label style="width:80%;text-align:right;font-weight:bold;">وضعیت فعلی</label>
        <input type="text" name="currentStatus" style="width:80%;padding:0.54rem;border-radius:6px;">
        <label style="width:80%;text-align:right;font-weight:bold;">توضیحات تکمیلی</label>
        <textarea name="notes" rows="2" style="width:80%;padding:0.54rem;border-radius:6px;"></textarea>
      </div>
    </div>
    <div style="display:flex;gap:0.5rem;margin-top:1.35rem;">
      <button type="submit" id="saveBtn" style="flex:1;background:linear-gradient(135deg,#2ecc71,#27ae60);color:#fff;font-weight:bold;border:none;border-radius:6px;padding:0.72rem;font-size:0.81rem;box-shadow:0 2px 4px rgba(0,0,0,0.08);"><i class="fa-solid fa-floppy-disk"></i> ثبت/ویرایش</button>
      <button type="button" id="deleteBtn" style="flex:1;background:linear-gradient(135deg,#e74c3c,#c0392b);color:#fff;font-weight:bold;border:none;border-radius:6px;padding:0.72rem;font-size:0.81rem;box-shadow:0 2px 4px rgba(0,0,0,0.08);"><i class="fa-solid fa-trash-can"></i> حذف</button>
    </div>
  </form>
  <div id="messageContainer" style="position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:300px;z-index:1000;text-align:center;pointer-events:none;opacity:0;transition:opacity 0.5s ease-in-out;">
    <div id="successMsg" style="display:none;font-weight:bold;font-size:0.85rem;padding:0.6rem;border-radius:5px;box-shadow:0 2px 10px rgba(0,0,0,0.2);color:#2ecc71;background-color:rgba(46,204,113,0.1);border:1px solid #2ecc71;"></div>
    <div id="errorMsg" style="display:none;font-weight:bold;font-size:0.85rem;padding:0.6rem;border-radius:5px;box-shadow:0 2px 10px rgba(0,0,0,0.2);color:#e74c3c;background-color:rgba(231,76,60,0.1);border:1px solid #e74c3c;"></div>
  </div>
  <div class="search-container" style="display:flex;flex-direction:row;align-items:center;gap:0.5rem;margin-top:2rem;">
    <input type="text" id="searchCode" placeholder="جستجو بر اساس کد دیوایس" style="flex:1;height:48px;font-size:0.81rem;border-radius:6px;box-shadow:0 2px 4px rgba(0,0,0,0.08);padding:0 1rem;">
    <button type="button" id="searchBtn" style="height:48px;font-size:0.81rem;border-radius:6px;box-shadow:0 2px 4px rgba(0,0,0,0.08);background:linear-gradient(135deg,#3498db,#2980b9);color:#fff;font-weight:bold;border:none;padding:0 1.2rem;display:flex;align-items:center;justify-content:center;"><i class="fa-solid fa-magnifying-glass"></i> جستجو</button>
  </div>
</div>

<!-- جی‌کوئری و تقویم شمسی -->
<script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/datepicker-fa/dist/datepicker.min.js"></script>
<script>
  // فعال سازی تقویم شمسی
  $(document).ready(function() {
    $('#issueDate').datepicker({
      autoClose: true,
      calendarType: 'persian',
      initialValueType: 'persian',
      format: 'yyyy/mm/dd'
    });
  });

  // سایر کدهای پیام و پرکردن فرم
  function showMessage(type, message) {
    const messageContainer = document.getElementById("messageContainer");
    const successMsg = document.getElementById("successMsg");
    const errorMsg = document.getElementById("errorMsg");
    if (!successMsg || !errorMsg || !messageContainer) return;
    const targetMsg = (type === "success") ? successMsg : errorMsg;
    const otherMsg = (type === "success") ? errorMsg : successMsg;
    targetMsg.textContent = message;
    messageContainer.style.opacity = "0.9";
    targetMsg.style.display = 'block';
    otherMsg.style.display = 'none';
    setTimeout(() => {
      messageContainer.style.opacity = "0";
    }, 3000);
  }

  function fillForm(data){
    if(!data) return;
    if (Object.keys(data).length > 0) {
      for(const key in data){
        const el = document.querySelector("[name='"+key+"']");
        if(el){
          el.value = data[key]||"";
        }
      }
      document.getElementById("barcodeDisplay").textContent = data.barcodeId || "---";
      showMessage("success", "✅ رکورد پیدا شد");
    } else {
      showMessage("error", "❌ رکورد پیدا نشد");
    }
  }

  // نمونه کد برای دکمه‌ها
  document.getElementById("deviceForm").addEventListener("submit", function(e){
    e.preventDefault();
    showMessage("success", "✅ عملیات موفقیت‌آمیز بود (نمونه)");
  });

  document.getElementById("deleteBtn").addEventListener("click", function(){
    if(confirm("آیا مطمئن هستید؟")) {
      document.getElementById("deviceForm").reset();
      document.getElementById("barcodeDisplay").textContent = "---";
      showMessage("success", "✅ رکورد حذف شد (نمونه)");
    }
  });

  document.getElementById("searchBtn").addEventListener("click", function(){
    const code = document.getElementById("searchCode").value.trim();
    if(!code) return showMessage("error", "❌ کد دیوایس وارد شود");
    showMessage("success", "✅ جستجو انجام شد (نمونه)");
  });
</script>
</body>
</html>
